// src-electron/electron-main.ts
import { app, ipcMain, BrowserWindow, dialog, shell } from "electron";
import path from "path";
import os from "os";
import { fileURLToPath } from "url";
import axios from "axios";
import fs from "node:fs/promises";
import { createWriteStream } from "node:fs";
var platform = process.platform || os.platform();
var currentDir = fileURLToPath(new URL(".", import.meta.url));
var mainWindow;
async function createWindow() {
  mainWindow = new BrowserWindow({
    icon: path.resolve(currentDir, "icons/icon.png"),
    // tray icon
    width: 1024,
    height: 768,
    useContentSize: true,
    webPreferences: {
      nodeIntegration: true,
      webSecurity: false,
      contextIsolation: true,
      sandbox: false,
      // More info: https://v2.quasar.dev/quasar-cli-vite/developing-electron-apps/electron-preload-script
      preload: path.resolve(
        currentDir,
        path.join("/Users/marcel/Desktop/Samantha/.quasar/dev-electron/preload", "electron-preload.cjs")
      )
    }
  });
  if (true) {
    await mainWindow.loadURL("http://localhost:9300");
  } else {
    await mainWindow.loadFile("index.html");
  }
  if (true) {
    mainWindow.webContents.openDevTools();
  } else {
    mainWindow.webContents.on("devtools-opened", () => {
      mainWindow?.webContents.closeDevTools();
    });
  }
  mainWindow.on("closed", () => {
    mainWindow = void 0;
  });
}
void app.whenReady().then(createWindow);
ipcMain.handle("pick-folder", async () => {
  const result = await dialog.showOpenDialog({
    properties: ["openDirectory", "createDirectory"]
  });
  if (result.canceled)
    return null;
  return result.filePaths[0];
});
ipcMain.on("setup-progress", (event, message) => {
  if (mainWindow)
    mainWindow.webContents.send("setup-progress", message);
});
ipcMain.on("open-folder", (event, folderPath) => {
  shell.openPath(folderPath);
});
ipcMain.handle("download-models", async (_event, dest, url) => {
  const response = await axios.get(url, { responseType: "stream" });
  await new Promise((resolve, reject) => {
    const stream = createWriteStream(dest);
    response.data.pipe(stream);
    stream.on("finish", resolve);
    stream.on("error", reject);
  });
  await fs.chmod(dest, 493);
  return { success: true };
});
ipcMain.handle("read-workspace", async (_event, folderPath) => {
  const projectsPath = path.join(folderPath, "projects");
  const dir = await fs.opendir(projectsPath);
  const dirs = [];
  for await (const dirent of dir)
    if (dirent.isDirectory())
      dirs.push(dirent.name);
  return dirs;
});
ipcMain.handle("file-exists", async (_event, filePath) => {
  try {
    await fs.access(filePath);
    return true;
  } catch {
    return false;
  }
});
ipcMain.handle("pick-file", async () => {
  const result = await dialog.showOpenDialog({
    properties: ["openFile"],
    filters: [
      { name: "Videos", extensions: ["mp4", "avi", "mov", "mkv", "webm", "wmv", "flv", "mpeg", "mpg"] }
    ]
  });
  if (result.canceled)
    return null;
  return result.filePaths[0];
});
app.on("window-all-closed", () => {
  if (platform !== "darwin") {
    app.quit();
  }
});
app.on("activate", () => {
  if (mainWindow === void 0) {
    void createWindow();
  }
});
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vc3JjLWVsZWN0cm9uL2VsZWN0cm9uLW1haW4udHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IGFwcCwgaXBjTWFpbiwgQnJvd3NlcldpbmRvdywgZGlhbG9nLCBzaGVsbCB9IGZyb20gJ2VsZWN0cm9uJ1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCdcbmltcG9ydCBvcyBmcm9tICdvcydcbmltcG9ydCB7IGZpbGVVUkxUb1BhdGggfSBmcm9tICd1cmwnXG5pbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnXG5pbXBvcnQgZnMgZnJvbSAnbm9kZTpmcy9wcm9taXNlcydcbmltcG9ydCB7IGNyZWF0ZVdyaXRlU3RyZWFtIH0gZnJvbSAnbm9kZTpmcydcblxuXG4vLyBuZWVkZWQgaW4gY2FzZSBwcm9jZXNzIGlzIHVuZGVmaW5lZCB1bmRlciBMaW51eFxuY29uc3QgcGxhdGZvcm0gPSBwcm9jZXNzLnBsYXRmb3JtIHx8IG9zLnBsYXRmb3JtKClcblxuY29uc3QgY3VycmVudERpciA9IGZpbGVVUkxUb1BhdGgobmV3IFVSTCgnLicsIGltcG9ydC5tZXRhLnVybCkpXG5cbmxldCBtYWluV2luZG93OiBCcm93c2VyV2luZG93IHwgdW5kZWZpbmVkXG5cbmFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVdpbmRvdygpIHtcbiAgLyoqXG4gICAqIEluaXRpYWwgd2luZG93IG9wdGlvbnNcbiAgICovXG4gIG1haW5XaW5kb3cgPSBuZXcgQnJvd3NlcldpbmRvdyh7XG4gICAgaWNvbjogcGF0aC5yZXNvbHZlKGN1cnJlbnREaXIsICdpY29ucy9pY29uLnBuZycpLCAvLyB0cmF5IGljb25cbiAgICB3aWR0aDogMTAyNCxcbiAgICBoZWlnaHQ6IDc2OCxcbiAgICB1c2VDb250ZW50U2l6ZTogdHJ1ZSxcbiAgICB3ZWJQcmVmZXJlbmNlczoge1xuICAgICAgbm9kZUludGVncmF0aW9uOiB0cnVlLFxuICAgICAgd2ViU2VjdXJpdHk6IGZhbHNlLFxuICAgICAgY29udGV4dElzb2xhdGlvbjogdHJ1ZSxcbiAgICAgIHNhbmRib3g6IGZhbHNlLFxuICAgICAgLy8gTW9yZSBpbmZvOiBodHRwczovL3YyLnF1YXNhci5kZXYvcXVhc2FyLWNsaS12aXRlL2RldmVsb3BpbmctZWxlY3Ryb24tYXBwcy9lbGVjdHJvbi1wcmVsb2FkLXNjcmlwdFxuICAgICAgcHJlbG9hZDogcGF0aC5yZXNvbHZlKFxuICAgICAgICBjdXJyZW50RGlyLFxuICAgICAgICBwYXRoLmpvaW4ocHJvY2Vzcy5lbnYuUVVBU0FSX0VMRUNUUk9OX1BSRUxPQURfRk9MREVSLCAnZWxlY3Ryb24tcHJlbG9hZCcgKyBwcm9jZXNzLmVudi5RVUFTQVJfRUxFQ1RST05fUFJFTE9BRF9FWFRFTlNJT04pXG4gICAgICApLFxuICAgIH0sXG4gIH0pXG5cbiAgaWYgKHByb2Nlc3MuZW52LkRFVikge1xuICAgIGF3YWl0IG1haW5XaW5kb3cubG9hZFVSTChwcm9jZXNzLmVudi5BUFBfVVJMKVxuICB9IFxuICBlbHNlIHtcbiAgICBhd2FpdCBtYWluV2luZG93LmxvYWRGaWxlKCdpbmRleC5odG1sJylcbiAgfVxuXG4gIGlmIChwcm9jZXNzLmVudi5ERUJVR0dJTkcpIHtcbiAgICAvLyBpZiBvbiBERVYgb3IgUHJvZHVjdGlvbiB3aXRoIGRlYnVnIGVuYWJsZWRcbiAgICBtYWluV2luZG93LndlYkNvbnRlbnRzLm9wZW5EZXZUb29scygpXG4gIH0gZWxzZSB7XG4gICAgLy8gd2UncmUgb24gcHJvZHVjdGlvbjsgbm8gYWNjZXNzIHRvIGRldnRvb2xzIHBsc1xuICAgIG1haW5XaW5kb3cud2ViQ29udGVudHMub24oJ2RldnRvb2xzLW9wZW5lZCcsICgpID0+IHtcbiAgICAgIG1haW5XaW5kb3c/LndlYkNvbnRlbnRzLmNsb3NlRGV2VG9vbHMoKTtcbiAgICB9KVxuICB9XG5cbiAgbWFpbldpbmRvdy5vbignY2xvc2VkJywgKCkgPT4ge1xuICAgIG1haW5XaW5kb3cgPSB1bmRlZmluZWQ7XG4gIH0pXG59XG5cbnZvaWQgYXBwLndoZW5SZWFkeSgpLnRoZW4oY3JlYXRlV2luZG93KTtcblxuLy8gcGljayBhIGZvbGRlciBmcm9tIHRoZSBmaWxlc3lzdGVtXG5pcGNNYWluLmhhbmRsZSgncGljay1mb2xkZXInLCBhc3luYyAoKSA9PiB7XG4gIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRpYWxvZy5zaG93T3BlbkRpYWxvZyh7XG4gICAgcHJvcGVydGllczogWydvcGVuRGlyZWN0b3J5JywgJ2NyZWF0ZURpcmVjdG9yeSddLCBcbiAgfSlcblxuICBpZiAocmVzdWx0LmNhbmNlbGVkKSBcbiAgICByZXR1cm4gbnVsbFxuXG4gIHJldHVybiByZXN1bHQuZmlsZVBhdGhzWzBdIFxufSlcblxuLy8ga2VlcCB0aGUgdXNlciBpbmZvcm1lZCBhYm91dCB0aGUgc2V0dXAgcHJvZ3Jlc3NcbmlwY01haW4ub24oJ3NldHVwLXByb2dyZXNzJywgKGV2ZW50LCBtZXNzYWdlKSA9PiB7XG4gIGlmIChtYWluV2luZG93KSBcbiAgICBtYWluV2luZG93LndlYkNvbnRlbnRzLnNlbmQoJ3NldHVwLXByb2dyZXNzJywgbWVzc2FnZSlcbn0pXG5cbi8vIG9wZW4gYSBmb2xkZXIgaW4gdGhlIHN5c3RlbSBmaWxlIGV4cGxvcmVyXG5pcGNNYWluLm9uKCdvcGVuLWZvbGRlcicsIChldmVudCwgZm9sZGVyUGF0aCkgPT4ge1xuICBzaGVsbC5vcGVuUGF0aChmb2xkZXJQYXRoKVxufSlcblxuLy8gZG93bmxvYWQgbW9kZWxzIGZyb20gYSBnaXZlbiBVUkwgYW5kIHNhdmUgdG8gYSBkZXN0aW5hdGlvbiBwYXRoXG5pcGNNYWluLmhhbmRsZSgnZG93bmxvYWQtbW9kZWxzJywgYXN5bmMgKF9ldmVudCwgZGVzdDogc3RyaW5nLCB1cmw6IHN0cmluZykgPT4ge1xuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGF4aW9zLmdldCh1cmwsIHsgcmVzcG9uc2VUeXBlOiAnc3RyZWFtJyB9KVxuICBhd2FpdCBuZXcgUHJvbWlzZTx2b2lkPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgY29uc3Qgc3RyZWFtID0gY3JlYXRlV3JpdGVTdHJlYW0oZGVzdClcbiAgICByZXNwb25zZS5kYXRhLnBpcGUoc3RyZWFtKVxuICAgIHN0cmVhbS5vbignZmluaXNoJywgcmVzb2x2ZSlcbiAgICBzdHJlYW0ub24oJ2Vycm9yJywgcmVqZWN0KVxuICB9KVxuXG4gIC8vIG1ha2UgdGhlIGZpbGUgZXhlY3V0YWJsZVxuICBhd2FpdCBmcy5jaG1vZChkZXN0LCAwbzc1NSlcblxuICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH1cbn0pXG5cbi8vIHJlYWQgYWxsIGRpcmVjdG9yaWVzIGluIHRoZSBwcm9qZWN0cyBmb2xkZXJcbmlwY01haW4uaGFuZGxlKCdyZWFkLXdvcmtzcGFjZScsIGFzeW5jIChfZXZlbnQsIGZvbGRlclBhdGg6IHN0cmluZykgPT4ge1xuICBjb25zdCBwcm9qZWN0c1BhdGggPSBwYXRoLmpvaW4oZm9sZGVyUGF0aCwgJ3Byb2plY3RzJylcbiAgY29uc3QgZGlyID0gYXdhaXQgZnMub3BlbmRpcihwcm9qZWN0c1BhdGgpXG4gIGNvbnN0IGRpcnM6IHN0cmluZ1tdID0gW11cblxuICBmb3IgYXdhaXQgKGNvbnN0IGRpcmVudCBvZiBkaXIpXG4gICAgaWYgKGRpcmVudC5pc0RpcmVjdG9yeSgpKSBcbiAgICAgIGRpcnMucHVzaChkaXJlbnQubmFtZSlcbiAgIFxuICByZXR1cm4gZGlyc1xufSlcblxuLy8gY2hlY2sgaWYgYSBmaWxlIGV4aXN0cyBvbiB0aGUgZmlsZXN5c3RlbVxuaXBjTWFpbi5oYW5kbGUoJ2ZpbGUtZXhpc3RzJywgYXN5bmMgKF9ldmVudCwgZmlsZVBhdGg6IHN0cmluZykgPT4ge1xuICB0cnkge1xuICAgIGF3YWl0IGZzLmFjY2VzcyhmaWxlUGF0aClcbiAgICByZXR1cm4gdHJ1ZVxuICB9IFxuICBjYXRjaCB7XG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cbn0pXG5cbi8vIG9wZW4gZmlsZSBleHBsb3JlciBhbmQgc2VsZWN0IGEgdmlkZW8gZmlsZVxuaXBjTWFpbi5oYW5kbGUoJ3BpY2stZmlsZScsIGFzeW5jICgpID0+IHtcbiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGlhbG9nLnNob3dPcGVuRGlhbG9nKHtcbiAgICBwcm9wZXJ0aWVzOiBbJ29wZW5GaWxlJ10sXG4gICAgZmlsdGVyczogW1xuICAgICAgeyBuYW1lOiAnVmlkZW9zJywgZXh0ZW5zaW9uczogWydtcDQnLCAnYXZpJywgJ21vdicsICdta3YnLCAnd2VibScsICd3bXYnLCAnZmx2JywgJ21wZWcnLCAnbXBnJ10gfVxuICAgIF1cbiAgfSlcblxuICBpZiAocmVzdWx0LmNhbmNlbGVkKSBcbiAgICByZXR1cm4gbnVsbFxuXG4gIHJldHVybiByZXN1bHQuZmlsZVBhdGhzWzBdXG59KVxuXG5hcHAub24oJ3dpbmRvdy1hbGwtY2xvc2VkJywgKCkgPT4ge1xuICBpZiAocGxhdGZvcm0gIT09ICdkYXJ3aW4nKSB7XG4gICAgYXBwLnF1aXQoKVxuICB9XG59KTtcblxuYXBwLm9uKCdhY3RpdmF0ZScsICgpID0+IHtcbiAgaWYgKG1haW5XaW5kb3cgPT09IHVuZGVmaW5lZCkge1xuICAgIHZvaWQgY3JlYXRlV2luZG93KClcbiAgfVxufSk7XG5cbiJdLAogICJtYXBwaW5ncyI6ICI7QUFBQSxTQUFTLEtBQUssU0FBUyxlQUFlLFFBQVEsYUFBYTtBQUMzRCxPQUFPLFVBQVU7QUFDakIsT0FBTyxRQUFRO0FBQ2YsU0FBUyxxQkFBcUI7QUFDOUIsT0FBTyxXQUFXO0FBQ2xCLE9BQU8sUUFBUTtBQUNmLFNBQVMseUJBQXlCO0FBSWxDLElBQU0sV0FBVyxRQUFRLFlBQVksR0FBRyxTQUFTO0FBRWpELElBQU0sYUFBYSxjQUFjLElBQUksSUFBSSxLQUFLLFlBQVksR0FBRyxDQUFDO0FBRTlELElBQUk7QUFFSixlQUFlLGVBQWU7QUFJNUIsZUFBYSxJQUFJLGNBQWM7QUFBQSxJQUM3QixNQUFNLEtBQUssUUFBUSxZQUFZLGdCQUFnQjtBQUFBO0FBQUEsSUFDL0MsT0FBTztBQUFBLElBQ1AsUUFBUTtBQUFBLElBQ1IsZ0JBQWdCO0FBQUEsSUFDaEIsZ0JBQWdCO0FBQUEsTUFDZCxpQkFBaUI7QUFBQSxNQUNqQixhQUFhO0FBQUEsTUFDYixrQkFBa0I7QUFBQSxNQUNsQixTQUFTO0FBQUE7QUFBQSxNQUVULFNBQVMsS0FBSztBQUFBLFFBQ1o7QUFBQSxRQUNBLEtBQUssS0FBSywrREFBNEMsc0JBQWtFO0FBQUEsTUFDMUg7QUFBQSxJQUNGO0FBQUEsRUFDRixDQUFDO0FBRUQsTUFBSSxNQUFpQjtBQUNuQixVQUFNLFdBQVcsUUFBUSx1QkFBbUI7QUFBQSxFQUM5QyxPQUNLO0FBQ0gsVUFBTSxXQUFXLFNBQVMsWUFBWTtBQUFBLEVBQ3hDO0FBRUEsTUFBSSxNQUF1QjtBQUV6QixlQUFXLFlBQVksYUFBYTtBQUFBLEVBQ3RDLE9BQU87QUFFTCxlQUFXLFlBQVksR0FBRyxtQkFBbUIsTUFBTTtBQUNqRCxrQkFBWSxZQUFZLGNBQWM7QUFBQSxJQUN4QyxDQUFDO0FBQUEsRUFDSDtBQUVBLGFBQVcsR0FBRyxVQUFVLE1BQU07QUFDNUIsaUJBQWE7QUFBQSxFQUNmLENBQUM7QUFDSDtBQUVBLEtBQUssSUFBSSxVQUFVLEVBQUUsS0FBSyxZQUFZO0FBR3RDLFFBQVEsT0FBTyxlQUFlLFlBQVk7QUFDeEMsUUFBTSxTQUFTLE1BQU0sT0FBTyxlQUFlO0FBQUEsSUFDekMsWUFBWSxDQUFDLGlCQUFpQixpQkFBaUI7QUFBQSxFQUNqRCxDQUFDO0FBRUQsTUFBSSxPQUFPO0FBQ1QsV0FBTztBQUVULFNBQU8sT0FBTyxVQUFVLENBQUM7QUFDM0IsQ0FBQztBQUdELFFBQVEsR0FBRyxrQkFBa0IsQ0FBQyxPQUFPLFlBQVk7QUFDL0MsTUFBSTtBQUNGLGVBQVcsWUFBWSxLQUFLLGtCQUFrQixPQUFPO0FBQ3pELENBQUM7QUFHRCxRQUFRLEdBQUcsZUFBZSxDQUFDLE9BQU8sZUFBZTtBQUMvQyxRQUFNLFNBQVMsVUFBVTtBQUMzQixDQUFDO0FBR0QsUUFBUSxPQUFPLG1CQUFtQixPQUFPLFFBQVEsTUFBYyxRQUFnQjtBQUM3RSxRQUFNLFdBQVcsTUFBTSxNQUFNLElBQUksS0FBSyxFQUFFLGNBQWMsU0FBUyxDQUFDO0FBQ2hFLFFBQU0sSUFBSSxRQUFjLENBQUMsU0FBUyxXQUFXO0FBQzNDLFVBQU0sU0FBUyxrQkFBa0IsSUFBSTtBQUNyQyxhQUFTLEtBQUssS0FBSyxNQUFNO0FBQ3pCLFdBQU8sR0FBRyxVQUFVLE9BQU87QUFDM0IsV0FBTyxHQUFHLFNBQVMsTUFBTTtBQUFBLEVBQzNCLENBQUM7QUFHRCxRQUFNLEdBQUcsTUFBTSxNQUFNLEdBQUs7QUFFMUIsU0FBTyxFQUFFLFNBQVMsS0FBSztBQUN6QixDQUFDO0FBR0QsUUFBUSxPQUFPLGtCQUFrQixPQUFPLFFBQVEsZUFBdUI7QUFDckUsUUFBTSxlQUFlLEtBQUssS0FBSyxZQUFZLFVBQVU7QUFDckQsUUFBTSxNQUFNLE1BQU0sR0FBRyxRQUFRLFlBQVk7QUFDekMsUUFBTSxPQUFpQixDQUFDO0FBRXhCLG1CQUFpQixVQUFVO0FBQ3pCLFFBQUksT0FBTyxZQUFZO0FBQ3JCLFdBQUssS0FBSyxPQUFPLElBQUk7QUFFekIsU0FBTztBQUNULENBQUM7QUFHRCxRQUFRLE9BQU8sZUFBZSxPQUFPLFFBQVEsYUFBcUI7QUFDaEUsTUFBSTtBQUNGLFVBQU0sR0FBRyxPQUFPLFFBQVE7QUFDeEIsV0FBTztBQUFBLEVBQ1QsUUFDTTtBQUNKLFdBQU87QUFBQSxFQUNUO0FBQ0YsQ0FBQztBQUdELFFBQVEsT0FBTyxhQUFhLFlBQVk7QUFDdEMsUUFBTSxTQUFTLE1BQU0sT0FBTyxlQUFlO0FBQUEsSUFDekMsWUFBWSxDQUFDLFVBQVU7QUFBQSxJQUN2QixTQUFTO0FBQUEsTUFDUCxFQUFFLE1BQU0sVUFBVSxZQUFZLENBQUMsT0FBTyxPQUFPLE9BQU8sT0FBTyxRQUFRLE9BQU8sT0FBTyxRQUFRLEtBQUssRUFBRTtBQUFBLElBQ2xHO0FBQUEsRUFDRixDQUFDO0FBRUQsTUFBSSxPQUFPO0FBQ1QsV0FBTztBQUVULFNBQU8sT0FBTyxVQUFVLENBQUM7QUFDM0IsQ0FBQztBQUVELElBQUksR0FBRyxxQkFBcUIsTUFBTTtBQUNoQyxNQUFJLGFBQWEsVUFBVTtBQUN6QixRQUFJLEtBQUs7QUFBQSxFQUNYO0FBQ0YsQ0FBQztBQUVELElBQUksR0FBRyxZQUFZLE1BQU07QUFDdkIsTUFBSSxlQUFlLFFBQVc7QUFDNUIsU0FBSyxhQUFhO0FBQUEsRUFDcEI7QUFDRixDQUFDOyIsCiAgIm5hbWVzIjogW10KfQo=

// src-electron/electron-main.ts
import { app, ipcMain, BrowserWindow, dialog, shell } from "electron";
import path from "path";
import os from "os";
import { fileURLToPath } from "url";
import axios from "axios";
import fs from "node:fs/promises";
import { createWriteStream } from "node:fs";
var platform = process.platform || os.platform();
var currentDir = fileURLToPath(new URL(".", import.meta.url));
var mainWindow;
async function createWindow() {
  mainWindow = new BrowserWindow({
    icon: path.resolve(currentDir, "icons/icon.png"),
    // tray icon
    width: 1024,
    height: 768,
    useContentSize: true,
    webPreferences: {
      nodeIntegration: true,
      webSecurity: false,
      contextIsolation: true,
      sandbox: false,
      // More info: https://v2.quasar.dev/quasar-cli-vite/developing-electron-apps/electron-preload-script
      preload: path.resolve(
        currentDir,
        path.join("/Users/marcel/Desktop/Samantha/.quasar/dev-electron/preload", "electron-preload.cjs")
      )
    }
  });
  if (true) {
    await mainWindow.loadURL("http://localhost:9300");
  } else {
    await mainWindow.loadFile("index.html");
  }
  if (true) {
    mainWindow.webContents.openDevTools();
  } else {
    mainWindow.webContents.on("devtools-opened", () => {
      mainWindow?.webContents.closeDevTools();
    });
  }
  mainWindow.on("closed", () => {
    mainWindow = void 0;
  });
}
void app.whenReady().then(createWindow);
ipcMain.handle("pick-folder", async () => {
  const result = await dialog.showOpenDialog({
    properties: ["openDirectory", "createDirectory"]
  });
  if (result.canceled)
    return null;
  return result.filePaths[0];
});
ipcMain.on("setup-progress", (event, message) => {
  if (mainWindow)
    mainWindow.webContents.send("setup-progress", message);
});
ipcMain.on("open-folder", (event, folderPath) => {
  shell.openPath(folderPath);
});
ipcMain.handle("download-models", async (_event, dest, url) => {
  const response = await axios.get(url, { responseType: "stream" });
  await new Promise((resolve, reject) => {
    const stream = createWriteStream(dest);
    response.data.pipe(stream);
    stream.on("finish", resolve);
    stream.on("error", reject);
  });
  await fs.chmod(dest, 493);
  return { success: true };
});
ipcMain.handle("read-workspace", async (_event, folderPath) => {
  const projectsPath = path.join(folderPath, "projects");
  const dir = await fs.opendir(projectsPath);
  const dirs = [];
  for await (const dirent of dir)
    if (dirent.isDirectory())
      dirs.push(dirent.name);
  return dirs;
});
ipcMain.handle("file-exists", async (_event, filePath) => {
  try {
    await fs.access(filePath);
    return true;
  } catch {
    return false;
  }
});
ipcMain.handle("pick-file", async () => {
  const result = await dialog.showOpenDialog({
    properties: ["openFile"],
    filters: [
      { name: "Videos", extensions: ["mp4", "avi", "mov", "mkv", "webm", "wmv", "flv", "mpeg", "mpg"] }
    ]
  });
  if (result.canceled)
    return null;
  return result.filePaths[0];
});
app.on("window-all-closed", () => {
  if (platform !== "darwin") {
    app.quit();
  }
});
app.on("activate", () => {
  if (mainWindow === void 0) {
    void createWindow();
  }
});
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vc3JjLWVsZWN0cm9uL2VsZWN0cm9uLW1haW4udHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IGFwcCwgaXBjTWFpbiwgQnJvd3NlcldpbmRvdywgZGlhbG9nLCBzaGVsbCB9IGZyb20gJ2VsZWN0cm9uJztcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0IG9zIGZyb20gJ29zJztcbmltcG9ydCB7IGZpbGVVUkxUb1BhdGggfSBmcm9tICd1cmwnXG5pbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnXG5pbXBvcnQgZnMgZnJvbSAnbm9kZTpmcy9wcm9taXNlcyc7XG5pbXBvcnQgeyBjcmVhdGVXcml0ZVN0cmVhbSB9IGZyb20gJ25vZGU6ZnMnO1xuXG5cbi8vIG5lZWRlZCBpbiBjYXNlIHByb2Nlc3MgaXMgdW5kZWZpbmVkIHVuZGVyIExpbnV4XG5jb25zdCBwbGF0Zm9ybSA9IHByb2Nlc3MucGxhdGZvcm0gfHwgb3MucGxhdGZvcm0oKTtcblxuY29uc3QgY3VycmVudERpciA9IGZpbGVVUkxUb1BhdGgobmV3IFVSTCgnLicsIGltcG9ydC5tZXRhLnVybCkpO1xuXG5sZXQgbWFpbldpbmRvdzogQnJvd3NlcldpbmRvdyB8IHVuZGVmaW5lZDtcblxuYXN5bmMgZnVuY3Rpb24gY3JlYXRlV2luZG93KCkge1xuICAvKipcbiAgICogSW5pdGlhbCB3aW5kb3cgb3B0aW9uc1xuICAgKi9cbiAgbWFpbldpbmRvdyA9IG5ldyBCcm93c2VyV2luZG93KHtcbiAgICBpY29uOiBwYXRoLnJlc29sdmUoY3VycmVudERpciwgJ2ljb25zL2ljb24ucG5nJyksIC8vIHRyYXkgaWNvblxuICAgIHdpZHRoOiAxMDI0LFxuICAgIGhlaWdodDogNzY4LFxuICAgIHVzZUNvbnRlbnRTaXplOiB0cnVlLFxuICAgIHdlYlByZWZlcmVuY2VzOiB7XG4gICAgICBub2RlSW50ZWdyYXRpb246IHRydWUsXG4gICAgICB3ZWJTZWN1cml0eTogZmFsc2UsXG4gICAgICBjb250ZXh0SXNvbGF0aW9uOiB0cnVlLFxuICAgICAgc2FuZGJveDogZmFsc2UsXG4gICAgICAvLyBNb3JlIGluZm86IGh0dHBzOi8vdjIucXVhc2FyLmRldi9xdWFzYXItY2xpLXZpdGUvZGV2ZWxvcGluZy1lbGVjdHJvbi1hcHBzL2VsZWN0cm9uLXByZWxvYWQtc2NyaXB0XG4gICAgICBwcmVsb2FkOiBwYXRoLnJlc29sdmUoXG4gICAgICAgIGN1cnJlbnREaXIsXG4gICAgICAgIHBhdGguam9pbihwcm9jZXNzLmVudi5RVUFTQVJfRUxFQ1RST05fUFJFTE9BRF9GT0xERVIsICdlbGVjdHJvbi1wcmVsb2FkJyArIHByb2Nlc3MuZW52LlFVQVNBUl9FTEVDVFJPTl9QUkVMT0FEX0VYVEVOU0lPTilcbiAgICAgICksXG4gICAgfSxcbiAgfSk7XG5cbiAgaWYgKHByb2Nlc3MuZW52LkRFVikge1xuICAgIGF3YWl0IG1haW5XaW5kb3cubG9hZFVSTChwcm9jZXNzLmVudi5BUFBfVVJMKTtcbiAgfSBlbHNlIHtcbiAgICBhd2FpdCBtYWluV2luZG93LmxvYWRGaWxlKCdpbmRleC5odG1sJyk7XG4gIH1cblxuICBpZiAocHJvY2Vzcy5lbnYuREVCVUdHSU5HKSB7XG4gICAgLy8gaWYgb24gREVWIG9yIFByb2R1Y3Rpb24gd2l0aCBkZWJ1ZyBlbmFibGVkXG4gICAgbWFpbldpbmRvdy53ZWJDb250ZW50cy5vcGVuRGV2VG9vbHMoKTtcbiAgfSBlbHNlIHtcbiAgICAvLyB3ZSdyZSBvbiBwcm9kdWN0aW9uOyBubyBhY2Nlc3MgdG8gZGV2dG9vbHMgcGxzXG4gICAgbWFpbldpbmRvdy53ZWJDb250ZW50cy5vbignZGV2dG9vbHMtb3BlbmVkJywgKCkgPT4ge1xuICAgICAgbWFpbldpbmRvdz8ud2ViQ29udGVudHMuY2xvc2VEZXZUb29scygpO1xuICAgIH0pO1xuICB9XG5cbiAgbWFpbldpbmRvdy5vbignY2xvc2VkJywgKCkgPT4ge1xuICAgIG1haW5XaW5kb3cgPSB1bmRlZmluZWQ7XG4gIH0pO1xufVxuXG52b2lkIGFwcC53aGVuUmVhZHkoKS50aGVuKGNyZWF0ZVdpbmRvdyk7XG5cbi8vIHBpY2sgYSBmb2xkZXIgZnJvbSB0aGUgZmlsZXN5c3RlbVxuaXBjTWFpbi5oYW5kbGUoJ3BpY2stZm9sZGVyJywgYXN5bmMgKCkgPT4ge1xuICBjb25zdCByZXN1bHQgPSBhd2FpdCBkaWFsb2cuc2hvd09wZW5EaWFsb2coe1xuICAgIHByb3BlcnRpZXM6IFsnb3BlbkRpcmVjdG9yeScsICdjcmVhdGVEaXJlY3RvcnknXSwgXG4gIH0pXG5cbiAgaWYgKHJlc3VsdC5jYW5jZWxlZCkgXG4gICAgcmV0dXJuIG51bGxcblxuICByZXR1cm4gcmVzdWx0LmZpbGVQYXRoc1swXSBcbn0pXG5cbi8vIGtlZXAgdGhlIHVzZXIgaW5mb3JtZWQgYWJvdXQgdGhlIHNldHVwIHByb2dyZXNzXG5pcGNNYWluLm9uKCdzZXR1cC1wcm9ncmVzcycsIChldmVudCwgbWVzc2FnZSkgPT4ge1xuICBpZiAobWFpbldpbmRvdykgXG4gICAgbWFpbldpbmRvdy53ZWJDb250ZW50cy5zZW5kKCdzZXR1cC1wcm9ncmVzcycsIG1lc3NhZ2UpXG59KTtcblxuLy8gb3BlbiBhIGZvbGRlciBpbiB0aGUgc3lzdGVtIGZpbGUgZXhwbG9yZXJcbmlwY01haW4ub24oJ29wZW4tZm9sZGVyJywgKGV2ZW50LCBmb2xkZXJQYXRoKSA9PiB7XG4gIHNoZWxsLm9wZW5QYXRoKGZvbGRlclBhdGgpXG59KVxuXG4vLyBkb3dubG9hZCBtb2RlbHMgZnJvbSBhIGdpdmVuIFVSTCBhbmQgc2F2ZSB0byBhIGRlc3RpbmF0aW9uIHBhdGhcbmlwY01haW4uaGFuZGxlKCdkb3dubG9hZC1tb2RlbHMnLCBhc3luYyAoX2V2ZW50LCBkZXN0OiBzdHJpbmcsIHVybDogc3RyaW5nKSA9PiB7XG4gIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXhpb3MuZ2V0KHVybCwgeyByZXNwb25zZVR5cGU6ICdzdHJlYW0nIH0pXG4gIGF3YWl0IG5ldyBQcm9taXNlPHZvaWQ+KChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBjb25zdCBzdHJlYW0gPSBjcmVhdGVXcml0ZVN0cmVhbShkZXN0KVxuICAgIHJlc3BvbnNlLmRhdGEucGlwZShzdHJlYW0pXG4gICAgc3RyZWFtLm9uKCdmaW5pc2gnLCByZXNvbHZlKVxuICAgIHN0cmVhbS5vbignZXJyb3InLCByZWplY3QpXG4gIH0pXG5cbiAgLy8gbWFrZSB0aGUgZmlsZXMgZXhlY3V0YWJsZVxuICBhd2FpdCBmcy5jaG1vZChkZXN0LCAwbzc1NSlcblxuICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH1cbn0pXG5cbi8vIHJlYWQgYWxsIGRpcmVjdG9yaWVzIGluIHRoZSBwcm9qZWN0cyBmb2xkZXJcbmlwY01haW4uaGFuZGxlKCdyZWFkLXdvcmtzcGFjZScsIGFzeW5jIChfZXZlbnQsIGZvbGRlclBhdGg6IHN0cmluZykgPT4ge1xuICBjb25zdCBwcm9qZWN0c1BhdGggPSBwYXRoLmpvaW4oZm9sZGVyUGF0aCwgJ3Byb2plY3RzJylcbiAgY29uc3QgZGlyID0gYXdhaXQgZnMub3BlbmRpcihwcm9qZWN0c1BhdGgpXG4gIGNvbnN0IGRpcnM6IHN0cmluZ1tdID0gW11cblxuICBmb3IgYXdhaXQgKGNvbnN0IGRpcmVudCBvZiBkaXIpXG4gICAgaWYgKGRpcmVudC5pc0RpcmVjdG9yeSgpKSBcbiAgICAgIGRpcnMucHVzaChkaXJlbnQubmFtZSlcbiAgIFxuICByZXR1cm4gZGlyc1xufSlcblxuLy8gd3JpdGUgXG4vKmlwY01haW4uaGFuZGxlKCd3cml0ZS13b3Jrc3BhY2UnLCBhc3luYyAoX2V2ZW50LCBmaWxlUGF0aDogc3RyaW5nLCBkYXRhOiBhbnkpID0+IHtcbiAgdHJ5IHtcbiAgICBhd2FpdCBmcy53cml0ZUZpbGUoZmlsZVBhdGgsIGRhdGEsICd1dGYtOCcpXG4gICAgcmV0dXJuIHRydWVcbiAgfVxuICBjYXRjaCAoZXJyKXtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciB3cml0aW5nIHdvcmtzcGFjZTonLCBlcnIpXG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cbn0pKi9cblxuLy8gY2hlY2sgaWYgYSBmaWxlIGV4aXN0cyBvbiB0aGUgZmlsZXN5c3RlbVxuaXBjTWFpbi5oYW5kbGUoJ2ZpbGUtZXhpc3RzJywgYXN5bmMgKF9ldmVudCwgZmlsZVBhdGg6IHN0cmluZykgPT4ge1xuICB0cnkge1xuICAgIGF3YWl0IGZzLmFjY2VzcyhmaWxlUGF0aClcbiAgICByZXR1cm4gdHJ1ZVxuICB9IFxuICBjYXRjaCB7XG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cbn0pXG5cbi8vIG9wZW4gZmlsZSBleHBsb3JlciBhbmQgc2VsZWN0IGEgdmlkZW8gZmlsZVxuaXBjTWFpbi5oYW5kbGUoJ3BpY2stZmlsZScsIGFzeW5jICgpID0+IHtcbiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGlhbG9nLnNob3dPcGVuRGlhbG9nKHtcbiAgICBwcm9wZXJ0aWVzOiBbJ29wZW5GaWxlJ10sXG4gICAgZmlsdGVyczogW1xuICAgICAgeyBuYW1lOiAnVmlkZW9zJywgZXh0ZW5zaW9uczogWydtcDQnLCAnYXZpJywgJ21vdicsICdta3YnLCAnd2VibScsICd3bXYnLCAnZmx2JywgJ21wZWcnLCAnbXBnJ10gfVxuICAgIF1cbiAgfSlcbiAgaWYgKHJlc3VsdC5jYW5jZWxlZCkgXG4gICAgcmV0dXJuIG51bGxcbiAgcmV0dXJuIHJlc3VsdC5maWxlUGF0aHNbMF1cbn0pXG5cbmFwcC5vbignd2luZG93LWFsbC1jbG9zZWQnLCAoKSA9PiB7XG4gIGlmIChwbGF0Zm9ybSAhPT0gJ2RhcndpbicpIHtcbiAgICBhcHAucXVpdCgpO1xuICB9XG59KTtcblxuYXBwLm9uKCdhY3RpdmF0ZScsICgpID0+IHtcbiAgaWYgKG1haW5XaW5kb3cgPT09IHVuZGVmaW5lZCkge1xuICAgIHZvaWQgY3JlYXRlV2luZG93KCk7XG4gIH1cbn0pO1xuXG4iXSwKICAibWFwcGluZ3MiOiAiO0FBQUEsU0FBUyxLQUFLLFNBQVMsZUFBZSxRQUFRLGFBQWE7QUFDM0QsT0FBTyxVQUFVO0FBQ2pCLE9BQU8sUUFBUTtBQUNmLFNBQVMscUJBQXFCO0FBQzlCLE9BQU8sV0FBVztBQUNsQixPQUFPLFFBQVE7QUFDZixTQUFTLHlCQUF5QjtBQUlsQyxJQUFNLFdBQVcsUUFBUSxZQUFZLEdBQUcsU0FBUztBQUVqRCxJQUFNLGFBQWEsY0FBYyxJQUFJLElBQUksS0FBSyxZQUFZLEdBQUcsQ0FBQztBQUU5RCxJQUFJO0FBRUosZUFBZSxlQUFlO0FBSTVCLGVBQWEsSUFBSSxjQUFjO0FBQUEsSUFDN0IsTUFBTSxLQUFLLFFBQVEsWUFBWSxnQkFBZ0I7QUFBQTtBQUFBLElBQy9DLE9BQU87QUFBQSxJQUNQLFFBQVE7QUFBQSxJQUNSLGdCQUFnQjtBQUFBLElBQ2hCLGdCQUFnQjtBQUFBLE1BQ2QsaUJBQWlCO0FBQUEsTUFDakIsYUFBYTtBQUFBLE1BQ2Isa0JBQWtCO0FBQUEsTUFDbEIsU0FBUztBQUFBO0FBQUEsTUFFVCxTQUFTLEtBQUs7QUFBQSxRQUNaO0FBQUEsUUFDQSxLQUFLLEtBQUssK0RBQTRDLHNCQUFrRTtBQUFBLE1BQzFIO0FBQUEsSUFDRjtBQUFBLEVBQ0YsQ0FBQztBQUVELE1BQUksTUFBaUI7QUFDbkIsVUFBTSxXQUFXLFFBQVEsdUJBQW1CO0FBQUEsRUFDOUMsT0FBTztBQUNMLFVBQU0sV0FBVyxTQUFTLFlBQVk7QUFBQSxFQUN4QztBQUVBLE1BQUksTUFBdUI7QUFFekIsZUFBVyxZQUFZLGFBQWE7QUFBQSxFQUN0QyxPQUFPO0FBRUwsZUFBVyxZQUFZLEdBQUcsbUJBQW1CLE1BQU07QUFDakQsa0JBQVksWUFBWSxjQUFjO0FBQUEsSUFDeEMsQ0FBQztBQUFBLEVBQ0g7QUFFQSxhQUFXLEdBQUcsVUFBVSxNQUFNO0FBQzVCLGlCQUFhO0FBQUEsRUFDZixDQUFDO0FBQ0g7QUFFQSxLQUFLLElBQUksVUFBVSxFQUFFLEtBQUssWUFBWTtBQUd0QyxRQUFRLE9BQU8sZUFBZSxZQUFZO0FBQ3hDLFFBQU0sU0FBUyxNQUFNLE9BQU8sZUFBZTtBQUFBLElBQ3pDLFlBQVksQ0FBQyxpQkFBaUIsaUJBQWlCO0FBQUEsRUFDakQsQ0FBQztBQUVELE1BQUksT0FBTztBQUNULFdBQU87QUFFVCxTQUFPLE9BQU8sVUFBVSxDQUFDO0FBQzNCLENBQUM7QUFHRCxRQUFRLEdBQUcsa0JBQWtCLENBQUMsT0FBTyxZQUFZO0FBQy9DLE1BQUk7QUFDRixlQUFXLFlBQVksS0FBSyxrQkFBa0IsT0FBTztBQUN6RCxDQUFDO0FBR0QsUUFBUSxHQUFHLGVBQWUsQ0FBQyxPQUFPLGVBQWU7QUFDL0MsUUFBTSxTQUFTLFVBQVU7QUFDM0IsQ0FBQztBQUdELFFBQVEsT0FBTyxtQkFBbUIsT0FBTyxRQUFRLE1BQWMsUUFBZ0I7QUFDN0UsUUFBTSxXQUFXLE1BQU0sTUFBTSxJQUFJLEtBQUssRUFBRSxjQUFjLFNBQVMsQ0FBQztBQUNoRSxRQUFNLElBQUksUUFBYyxDQUFDLFNBQVMsV0FBVztBQUMzQyxVQUFNLFNBQVMsa0JBQWtCLElBQUk7QUFDckMsYUFBUyxLQUFLLEtBQUssTUFBTTtBQUN6QixXQUFPLEdBQUcsVUFBVSxPQUFPO0FBQzNCLFdBQU8sR0FBRyxTQUFTLE1BQU07QUFBQSxFQUMzQixDQUFDO0FBR0QsUUFBTSxHQUFHLE1BQU0sTUFBTSxHQUFLO0FBRTFCLFNBQU8sRUFBRSxTQUFTLEtBQUs7QUFDekIsQ0FBQztBQUdELFFBQVEsT0FBTyxrQkFBa0IsT0FBTyxRQUFRLGVBQXVCO0FBQ3JFLFFBQU0sZUFBZSxLQUFLLEtBQUssWUFBWSxVQUFVO0FBQ3JELFFBQU0sTUFBTSxNQUFNLEdBQUcsUUFBUSxZQUFZO0FBQ3pDLFFBQU0sT0FBaUIsQ0FBQztBQUV4QixtQkFBaUIsVUFBVTtBQUN6QixRQUFJLE9BQU8sWUFBWTtBQUNyQixXQUFLLEtBQUssT0FBTyxJQUFJO0FBRXpCLFNBQU87QUFDVCxDQUFDO0FBZUQsUUFBUSxPQUFPLGVBQWUsT0FBTyxRQUFRLGFBQXFCO0FBQ2hFLE1BQUk7QUFDRixVQUFNLEdBQUcsT0FBTyxRQUFRO0FBQ3hCLFdBQU87QUFBQSxFQUNULFFBQ007QUFDSixXQUFPO0FBQUEsRUFDVDtBQUNGLENBQUM7QUFHRCxRQUFRLE9BQU8sYUFBYSxZQUFZO0FBQ3RDLFFBQU0sU0FBUyxNQUFNLE9BQU8sZUFBZTtBQUFBLElBQ3pDLFlBQVksQ0FBQyxVQUFVO0FBQUEsSUFDdkIsU0FBUztBQUFBLE1BQ1AsRUFBRSxNQUFNLFVBQVUsWUFBWSxDQUFDLE9BQU8sT0FBTyxPQUFPLE9BQU8sUUFBUSxPQUFPLE9BQU8sUUFBUSxLQUFLLEVBQUU7QUFBQSxJQUNsRztBQUFBLEVBQ0YsQ0FBQztBQUNELE1BQUksT0FBTztBQUNULFdBQU87QUFDVCxTQUFPLE9BQU8sVUFBVSxDQUFDO0FBQzNCLENBQUM7QUFFRCxJQUFJLEdBQUcscUJBQXFCLE1BQU07QUFDaEMsTUFBSSxhQUFhLFVBQVU7QUFDekIsUUFBSSxLQUFLO0FBQUEsRUFDWDtBQUNGLENBQUM7QUFFRCxJQUFJLEdBQUcsWUFBWSxNQUFNO0FBQ3ZCLE1BQUksZUFBZSxRQUFXO0FBQzVCLFNBQUssYUFBYTtBQUFBLEVBQ3BCO0FBQ0YsQ0FBQzsiLAogICJuYW1lcyI6IFtdCn0K
